---
title: "sub_saharan_africa_esperance"
author: "AKANHO_Naofal"
date: "2025-01-30"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
editor_options: 
  markdown: 
    wrap: 80
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

L'esp√©rance de vie est un indicateur fondamental du d√©veloppement humain,
refl√©tant la qualit√© de vie, l'acc√®s aux soins de sant√© et les conditions
socio-√©conomiques d'une population. Dans les pays d'Afrique subsaharienne, cet
indicateur varie consid√©rablement en raison de multiples facteurs, notamment
l'acc√®s aux infrastructures m√©dicales, les niveaux d'√©ducation, le revenu par
habitant et l'impact des maladies infectieuses. Cette √©tude vise √† analyser les
d√©terminants de l'esp√©rance de vie dans cette r√©gion, en exploitant un ensemble
de donn√©es issues de sources fiables. √Ä travers des m√©thodes d'analyse
statistique et de mod√©lisation, nous chercherons √† identifier les variables les
plus influentes et √† d√©gager des tendances pouvant orienter les politiques
publiques en mati√®re de sant√© et de d√©veloppement.

# Mat√©riels et M√©thodes

1.  Donn√©es :

**Source** : Kaggle :
<https://www.kaggle.com/datasets/mjshri23/life-expectancy-and-socio-economic-world-bank>

**R√©gion √©tudi√©e** : Afrique subsaharienne

Observations : Donn√©es filtr√©es sur plusieurs ann√©es et pays

Variables disponibles : indicateurs √©conomiques, environnementaux et sanitaires

2.  Description des variables

-   **Country Name** : Nom du pays

-   **IncomeGroup** : Classe de revenu du pays

-   **Year** : Ann√©e (2001 √† 2019 inclut)

-   **Life Expectancy World Bank** : Esp√©rance de vie

-   **Prevalence of Undernourishment** : La pr√©valence de la sous-alimentation
    est le pourcentage de la population dont la consommation alimentaire
    habituelle est insuffissante pour fournir les niveaux d'√©nergie alimentaire
    n√©cessaires au maintien d'une vie normalement active et saine

-   **CO2** : √âmissions de CO‚ÇÇ(Celles qui proviennent de la combustion de
    combustibles fossiles et de la fabrication de ciment)

-   **Health Expenditure %** : D√©penses de sant√© en % du PIB

-   **Unemployment** : Le ch√¥mage fait r√©f√©rence √† la part en pourcentage de la
    population active qui est sans travail mais disponible et √† la recherche
    d'un emploi.

-   **Injuries (Blessures)** : Les AVCI dues aux blessures repr√©sentent la perte
    de sant√© en raison des blessures, qu'elles soient caus√©es par des accidents,
    des traumatismes ou d'autres causes.

-   **Communicable** **(Maladies Transmissibles)** : Les AVCI dues aux maladies
    transmissibles incluent les maladies infectieuses, telles que le paludisme,
    la tuberculose ou le VIH/SIDA.

-   **NonCommunicable (Maladies Non Transmissibles)** : Les AVCI dues aux
    maladies non transmissibles incluent des maladies chroniques comme le
    diab√®te, les maladies cardiovasculaires et les cancers.

**AVCI** : **Ann√©es de Vie Corrig√©es de l'Incapacit√©**

L'**AVCI** (**Disability-Adjusted Life Years - DALY** en anglais) est une
**mesure de la charge globale de morbidit√©** dans une population. Elle
repr√©sente **la perte totale d'ann√©es de vie en bonne sant√©** due √† une maladie,
une blessure ou un probl√®me de sant√©.

**Formule de l'AVCI** :

**AVCI = AVP + AVI**

o√π :

-   **AVP (Ann√©es de Vie Perdues)** ‚Üí Ann√©es perdues √† cause d'un d√©c√®s
    pr√©matur√©.

-   **AVI (Ann√©es V√©cues avec une Incapacit√©)** ‚Üí Ann√©es v√©cues avec une maladie
    ou une incapacit√© qui r√©duit la qualit√© de vie.

### üîπ **Comment interpr√©ter l'AVCI ?**

-   **1 AVCI = 1 ann√©e de vie en bonne sant√© perdue.**

-   Plus l'AVCI est **√©lev√©**, plus la maladie ou l'accident a un **impact
    n√©gatif** sur la sant√© publique.

-   L'AVCI permet aux chercheurs et aux d√©cideurs de **comparer l'impact** de
    diff√©rentes maladies sur une population.

### üîπ **Exemples concrets**

üìå **Un accident grave** :

-   Une personne devient paralys√©e apr√®s un accident de voiture √† **30 ans** et
    vit jusqu'√† **70 ans**.

-   Elle perd **40 ann√©es de vie en bonne sant√©** √† cause du handicap ‚Üí **40
    AVCI**.

üìå **Une maladie infectieuse** (ex : paludisme) :

-   Si **1000 personnes** meurent pr√©matur√©ment √† **40 ans** au lieu de **70
    ans**, cela repr√©sente **30 000 AVP**.

-   Si **5000 personnes** souffrent de s√©quelles pendant **5 ans** avec un
    impact mod√©r√© (0.5 de gravit√©), cela fait **12 500 AVI**.

-   **AVCI total** = 30 000 + 12 500 = **42 500 AVCI**.

# Code et Discussions

## Chargement des donn√©es

```{r}
library(readr)
library(car) 
data <- read_csv("data.csv", show_col_types = FALSE)
```

## Exploration des donn√©es

### V√©rification des valeurs manquantes

```{r}
library(ggplot2)

# Calculer le nombre de valeurs manquantes par colonne
missing_data <- data.frame(
  variable = names(data),
  missing_count = colSums(is.na(data))
)

# Barplot avec annotations des valeurs manquantes
ggplot(missing_data, aes(x = reorder(variable, -missing_count), y = missing_count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  geom_text(aes(label = missing_count), hjust = -0.3, color = "black") +  # Ajouter le texte
  labs(title = "Nombre de valeurs manquantes par variable", x = "Variable", y = "Valeurs manquantes") +
  theme_minimal() +
  coord_flip()  # Inverser les axes
```

**Constat** : Il y a pas de valeurs manquantes.

```{r}
dim(data)
```

**Constat** : Dans notre base de donn√©e nous avions 589 observations et 16
variables.

```{r}
# Nombre de pays (N)
library(dplyr)
N <- data %>%
  distinct(`Country`) %>%
  nrow()

# Nombre d'ann√©es (T)
T <- data %>%
  distinct(Year) %>%
  nrow()

# Affichage des r√©sultats
cat("Nombre de pays (N) :", N, "\n")
cat("Nombre d'ann√©es (T) :", T, "\n")
cat("Taille totale du panel (N x T) :", N * T, "\n")

```

### Statistiques descriptives

```{r}
summary(data)
```

**Observations** :

1\. **Year** : Les ann√©es vont de 2001 √† 2019. La m√©diane et la moyenne sont
2010, indiquant une r√©partition uniforme des donn√©es sur cette p√©riode.

2\. **Life Expectancy World Bank (Esp√©rance de vie)** : L'esp√©rance de vie
minimale est de 40,37 ans, tandis que la maximale est de 74,51 ans. La moyenne
est de 57,52 ans, avec un premier quartile √† 52,31 ans, ce qui montre que la
majorit√© des pays a une esp√©rance de vie inf√©rieure √† 60 ans.

3\. **Prevalence of Undernourishment (Pr√©valence de la sous-alimentation)** : La
sous-alimentation varie fortement, de 3,10 % √† 67,50 %, avec une moyenne de
20,02 %. Le premier quartile est √† 10,60 %, donc 25 % des pays ont une
pr√©valence de sous-alimentation tr√®s faible. En revanche, la valeur maximale
(67,5 %) montre que certains pays sont s√©v√®rement touch√©s par la faim.

4\. **CO2 (√âmissions de CO‚ÇÇ en tonnes)** : Les √©missions vont de 50 tonnes √† un
maximum de 447 930 tonnes, ce qui r√©v√®le une disparit√© importante entre les
pays. La m√©diane est de 3 570 tonnes, indiquant que 50 % des pays √©mettent des
quantit√©s relativement faibles. Cependant, la moyenne est de 20 876 tonnes,
influenc√©e par des valeurs maximales tr√®s √©lev√©es.

5\. **Health Expenditure % (D√©penses de sant√© en pourcentage du PIB)** : Les
d√©penses varient de 2,39 % √† 20,41 %, avec une moyenne de 5,54 %. Le troisi√®me
quartile est √† 6,85 %, indiquant que 75 % des pays d√©pensent moins de 7 % de
leur PIB pour la sant√©.

6\. **Unemployment (Ch√¥mage)** : Le taux de ch√¥mage varie de 0,6 % √† 34,6 %. La
m√©diane est de 5,53 %, mais la moyenne est plus √©lev√©e √† 8,81 %, ce qui sugg√®re
que certains pays affichent des taux de ch√¥mage tr√®s √©lev√©s, influen√ßant la
moyenne.

7\. **Injuries (Blessures)** : Le nombre de blessures va de 3 268 √† 5 966 517.
La m√©diane est de 440 064, et la moyenne est de 824 675, encore une fois
influenc√©e par quelques pays ayant des valeurs extr√™mement √©lev√©es.

8\. **Communicable (Maladies transmissibles)** : Les maladies transmissibles
varient de 16 170 √† 103 785 391. La m√©diane est de 5 434 699, ce qui indique que
la majorit√© des pays ont des charges significatives de maladies transmissibles.

9\. **NonCommunicable (Maladies non transmissibles)** : Ces maladies vont de 24
499 √† 31 050 076. La m√©diane est de 1 993 660, montrant que les maladies non
transmissibles repr√©sentent une charge importante dans la plupart des pays.

**On peut conclure** :

**Disparit√©s importantes** : Les donn√©es montrent de grandes disparit√©s entre
les pays, notamment en termes de CO‚ÇÇ, ch√¥mage, et sant√©.

**In√©galit√©s de sant√©** : La pr√©valence de la sous-alimentation et l'esp√©rance
de vie varient fortement, ce qui refl√®te des in√©galit√©s importantes.

**Charge de maladies** : Les maladies transmissibles dominent dans certains
pays, mais les maladies non transmissibles sont aussi pr√©occupantes.

## Pr√©parer les donn√©es pour l'analyse de panel :

```{r}
library(dplyr)

panel_data <- data %>%
  mutate(
    `Country` = as.factor(Country),  # Convertir en facteur (correct)
    IncomeGroup = as.factor(IncomeGroup),       
    Year = as.numeric(Year)                     
  )

```

## Transformer les Donn√©es en Format Panel

```{r}
library(plm)
colnames(panel_data) <- gsub(" ", "_", colnames(panel_data))
panel_data <- pdata.frame(panel_data, index = c("Country", "Year"))

```

## Visualisations Exploratoires

### Scatterplot avec lissage pour Life_Expectancy_World_Bank vs Year par Country

```{r}
scatterplot(Life_Expectancy_World_Bank ~ Year | Country, boxplots=FALSE, smooth=TRUE, reg.line=FALSE, data=panel_data)

```

Cette visualisation montre l'√©volution du **Life_Expectancy_World_Bank** sous
forme de bo√Ætes √† moustaches (boxplots) de 2010 √† 2019.

**Observation** :

L'esp√©rance de vie a tendance √† augmenter progressivement au fil des ann√©es. La
m√©diane (ligne dans chaque bo√Æte) montre une hausse constante.

**Pr√©sence d'outliers** :

-   Il y a des valeurs aberrantes (outliers) visibles en haut du graphique.

-   Ces valeurs semblent √™tre des pays ayant une esp√©rance de vie tr√®s √©lev√©e
    par rapport √† la majorit√©.

**Conclusion** :

L'esp√©rance de vie suit une tendance haussi√®re sans fluctuations majeures.

### **Plotmeans pour d√©tecter l'h√©t√©rog√©n√©it√© √† travers les pays**

```{r}
library(gplots)
plotmeans(Life_Expectancy_World_Bank ~ Country, main="H√©t√©rog√©n√©it√© de l'esp√©rance de vie par pays", data=panel_data)

```

**Observation** :

L'esp√©rance de vie varie fortement d'un pays √† l'autre.

On peut soup√ßonner des effets sp√©cifiques entre les pays.

### **Plotmeans pour d√©tecter l'h√©t√©rog√©n√©it√© √† travers les ann√©es**

```{r}
plotmeans(Life_Expectancy_World_Bank ~ Year, main="H√©t√©rog√©n√©it√© de l'esp√©rance de vie par ann√©e", data=panel_data)
```

**Observations :**

1.  **Tendance g√©n√©rale** : L'esp√©rance de vie montre une augmentation
    progressive de 2001 √† 2019.

2.  **Dispersion des donn√©es** : Les barres d'erreur (en bleu) indiquent une
    h√©t√©rog√©n√©it√© de l'esp√©rance de vie pour chaque ann√©e, sugg√©rant une
    variabilit√© entre les pays d'Afrique subsaharienne.

3.  **√âvolution de la variabilit√©** : La dispersion semble √™tre plus grande au
    d√©but (2000-2010) et se r√©duit l√©g√®rement apr√®s 2010, ce qui pourrait
    indiquer une convergence progressive des esp√©rances de vie entre les pays.

### **Analyse de Corr√©lation**

#### **S√©lection des variables num√©riques pour l'analyse de corr√©lation**

```{r}
var_numerique = data %>% 
  select(
    "Life Expectancy World Bank",
    "Prevelance of Undernourishment",
    CO2,
    "Health Expenditure %",
    Unemployment,
    Injuries,
    Communicable,
    NonCommunicable
  )
```

#### **Calcul de la matrice de corr√©lation**

```{r}
cor_matrix <- cor(var_numerique, use = "complete.obs")

```

#### **Affichage de la matrice de corr√©lation**

```{r}
print(cor_matrix)

```

#### **Visualisation de la matrice de corr√©lation avec corrplot**

```{r}
library(corrplot)
corrplot(cor_matrix, method = "color", type = "upper",
         tl.col = "black", tl.srt = 45,
         addCoef.col = "black", # Ajoute les coefficients
         number.cex = 0.7,
         title = "Matrice de Corr√©lation des Variables",
         mar = c(0,0,1,0))
```

#### Gestion des Variables AVCI

Les trois variables (Injuries,Communicable,NonCommunicable)

#### V√©rification et Quantification de la Multicolin√©arit√©

```{r}
library(car)
vif(lm(Life_Expectancy_World_Bank ~ Injuries + Communicable + NonCommunicable + 
         Prevelance_of_Undernourishment + CO2 + Health_Expenditure_. + Unemployment, 
       data = panel_data))

```

**Observation :**

-   **Injuries (22.5)**, **Communicable (10.2)** et **NonCommunicable (26.8)**
    ont des VIF tr√®s √©lev√©s (**\> 10**), ce qui confirme une **forte
    multicolin√©arit√©**.

-   Les autres variables ont des VIF acceptables (**\< 5**), donc elles ne
    posent pas de probl√®me.

#### Solution :

Plusieurs options s'offre √† nous :

--------------------------------------------------------------------------------

üîπ **1. Faire une somme des trois variables**
(`Injuries + Communicable + NonCommunicable`)

üí° **Id√©e :** Tu cr√©es une nouvelle variable comme √©tant la **somme brute** des
trois.

üìå **Probl√®mes :**

-   **Suppose que toutes les variables ont le m√™me poids**, ce qui n'est pas
    forc√©ment vrai.

-   **Ne corrige pas la colin√©arit√©**, car elle persiste toujours dans les
    donn√©es.

-   **Ne tient pas compte des √©chelles diff√©rentes** (ex. `Injuries` pourrait
    √™tre plus grand que `Communicable`, donc influencer plus le r√©sultat).

üìä **Quand l'utiliser ?**\
‚úÖ Si toutes les variables ont un **impact √©quivalent** et sont **exprim√©es dans
la m√™me unit√©**.\
‚ùå Si elles ont des corr√©lations √©lev√©es et des unit√©s diff√©rentes, cela peut
biaiser le mod√®le.

--------------------------------------------------------------------------------

üîπ **2. Utiliser une PCA pour cr√©er une nouvelle variable**

üí° **Id√©e :** La PCA va transformer les variables en **composantes
principales**, en essayant de **maximiser la variance expliqu√©e**.

üìå **Avantages :**

-   **Corrige la colin√©arit√©** en regroupant l'information de mani√®re optimis√©e.

-   **Attribue un poids diff√©rent √† chaque variable** (selon leur importance
    statistique).

-   **Standardise les variables** pour √©viter qu'une seule variable domine la
    nouvelle composante.

-   **R√©duit la redondance** tout en conservant l'essentiel des informations.

üìä **Comment √ßa marche ?**\
La **premi√®re composante principale (PC1)** est une combinaison lin√©aire des
trois variables, pond√©r√©e de mani√®re optimale

--------------------------------------------------------------------------------

üîπ **3. Utiliser la r√©gression Ridge ou Lasso**

üí° **Id√©e :** Ces techniques p√©nalisent les variables trop corr√©l√©es, √©vitant
d'en privil√©gier une seule

‚úÖ **Option : Faire une Analyse en Composantes Principales (PCA) :** Regrouper
ces variables en une seule composante

-   Cr√©e une **nouvelle variable unique** qui r√©sume les trois (Injuries,
    Communicable et NonCommunicable).

```{r}
library(FactoMineR)
pca_result <- PCA(panel_data[, c("Injuries", "Communicable", "NonCommunicable")], scale.unit = TRUE)
pca_result
```

```{r}
pca_scores <- pca_result$ind$coord[,1]  # Premi√®re composante principale
panel_data$Health_Risk_Index <- pca_scores  # Nouvelle variable
```

üìå **Interpr√©tation :**

-   `Health_Risk_Index` est une **nouvelle variable** qui repr√©sente au mieux
    l'effet combin√© de `Injuries`, `Communicable` et `NonCommunicable`, en
    tenant compte de leurs corr√©lations et pond√©rations.

-   Cette nouvelle variable **r√©duit la dimensionnalit√©** tout en minimisant la
    perte d'information.

```{r}
library(car)
vif(lm(Life_Expectancy_World_Bank ~ Prevelance_of_Undernourishment + CO2 + Health_Expenditure_. + Unemployment+ Health_Risk_Index, 
       data = panel_data))
```

**Observation** : Le probl√®me de multicolin√©arit√© a √©t√© r√©solu.

Tous les VIF sont inf√©rieurs √† 5, ce qui signifie que le mod√®le ne pr√©sente plus
de multicolin√©arit√© probl√©matique.

```{r}
numerique = panel_data %>% 
  select(
    Life_Expectancy_World_Bank,
    Prevelance_of_Undernourishment,
    CO2,
    Health_Expenditure_.,
    Unemployment,
    Health_Risk_Index
  )
```

```{r}
matrix_correlation <- cor(numerique, use = "complete.obs")

```

```{r}
library(corrplot)
corrplot(matrix_correlation, method = "color", type = "upper",
         tl.col = "black", tl.srt = 45,
         addCoef.col = "black", # Ajoute les coefficients
         number.cex = 0.7,
         title = "Matrice de Corr√©lation des Variables",
         mar = c(0,0,1,0))
```

### Retrait des variables correl√©es

```{r}
library(dplyr)
panel <- panel_data %>%
  select(-Injuries, -Communicable, -NonCommunicable)
```

# Mod√©lisation :

## V√©rifier la stationnarit√© des variables

-   Si toutes les variables sont stationnaires (I(0)), un **panel simple** est
    suffisant.

-   Si certaines sont I(0)et d'autres I(1), alors un **ARDL panel** peut √™tre
    plus adapt√©. ‚úÖ **Si elles sont** I(1) et co-int√©gr√©es, on utilise un ARDL
    panel.\
    ‚úÖ **Si elles sont** I(1) mais non co-int√©gr√©es, on peut penser √†
    diff√©rencier ou utiliser un GMM.

    ```{r}
    library(tseries)
    # S√©lectionner uniquement les colonnes num√©riques (exclure les ID, noms, etc.)
    numerical_cols <- names(panel)[sapply(panel, is.numeric)]

    # Fonction pour tester la stationnarit√© avec ADF et KPSS
    test_stationnarite <- function(col) {
      adf_pvalue <- adf.test(panel[[col]], alternative = "stationary")$p.value

      adf_result <- ifelse(adf_pvalue < 0.05, "Stationnaire", "Non Stationnaire")

      return(data.frame(Variable = col, ADF = adf_result))
    }

    # Appliquer le test sur toutes les variables num√©riques
    resultats_stationnarite <- do.call(rbind, lapply(numerical_cols, test_stationnarite))

    # Afficher les r√©sultats
    print(resultats_stationnarite)
    ```

    **Conclusion** : Toute nos variables sont stationnaires, on peut effectuer
    un panel simple sur nos donn√©es.

## **Estimation du mod√®le Pooled**

```{r}
pooled_model <- plm(Life_Expectancy_World_Bank ~ 
                      Prevelance_of_Undernourishment + 
                      CO2 + 
                      Health_Expenditure_. + 
                      Unemployment + 
                      Health_Risk_Index + 
                      IncomeGroup, 
                    data = panel, 
                    model = "pooling")
summary(pooled_model)
```

### üìä **Interpr√©tation des r√©sultats**

1.  **Significativit√© des variables**

    -   `Prevalence_of_Undernourishment` (**p \< 2.2e-16**): Fortement
        significatif, impact n√©gatif sur l'esp√©rance de vie, ce qui sugg√®re
        qu'une plus grande pr√©valence de la sous-alimentation est associ√©e √† une
        esp√©rance de vie plus faible.

    -   `Unemployment` (**p \< 2.2e-16**): N√©gatif et significatif, donc plus de
        ch√¥mage r√©duit l'esp√©rance de vie autrement dit des taux de ch√¥mage plus
        √©lev√©s sont associ√©s √† une esp√©rance de vie plus courte.

    -   `Health_Risk_Index` (**p = 5.030e-07**): N√©gatif et significatif, ce qui
        est logique,une valeur plus √©lev√©e de cet indice semble r√©duire
        l'esp√©rance de vie.

    -   `IncomeGroupUpper middle income` (**p = 5.623e-16**): Positif et
        significatif ‚Üí un niveau de revenu plus √©lev√© am√©liore l'esp√©rance de
        vie autrement dit un groupe de revenu moyen sup√©rieur est associ√© √† une
        esp√©rance de vie significativement plus √©lev√©e.

2.  **Variables non significatives**

    -   `CO2` (**p = 0.9236**) et `Health_Expenditure_.` (**p = 0.9136**) ne
        sont pas significatifs.

    -   `IncomeGroupLower middle income` (**p = 0.7790**) n'a pas d'effet
        statistiquement prouv√©.

Cela sugg√®re que ces variables ne jouent pas un r√¥le direct significatif dans
l'esp√©rance de vie dans ce mod√®le.

3.  **Qualit√© du mod√®le**

    -   **R¬≤ = 0.313** ‚Üí Seulement 31% de la variance de l'esp√©rance de vie est
        expliqu√©e. D'autres facteurs cl√©s sont peut-√™tre absents.

    -   **F-statistique tr√®s significatif** p-value tr√®s faible (\< 2.22e-16) ‚Üí
        le mod√®le global est pertinent, c'est-√†-dire que les variables prises
        ensemble ont un pouvoir explicatif pour l'esp√©rance de vie.

**Conclusion** :

Les pays avec un revenu moyen sup√©rieur (**IncomeGrouUppper middle income**)
ont, en moyenne, une esp√©rance de vie plus
√©lev√©e(**Life_Expectancy_World_Bank**), ce qui est coh√©rent avec des niveaux de
d√©veloppement √©conomique plus avanc√©s. Le ch√¥mage(**Unemployment**), la
sous-alimentation(**Prevelance_of_Undernourishment**) et l'indice de risque
sanitaire(**Health_Risk_Index**) apparaissent comme des facteurs ayant un effet
n√©gatif important sur l'esp√©rance de vie, et ces effets sont assez homog√®nes √†
travers les pays et les ann√©es.

La variabilit√© dans les donn√©es r√©siduelles (les r√©sidus montrent une variation
notable avec des valeurs allant de -11.59 √† 14.64) sugg√®re qu'il pourrait y
avoir des effets sp√©cifiques aux pays ou aux p√©riodes non captur√©s dans ce
mod√®le simple.

Un mod√®le avec des **effets fixes** ou **al√©atoires** pourrait donner une
meilleure vue d'ensemble sur les diff√©rences entre les pays et les ann√©es, en
tenant compte de ces sp√©cificit√©s, en particulier si on est int√©ress√© par
l'√©volution de l'esp√©rance de vie au fil du temps pour chaque pays.

## **Mod√®le √† Effets Fixes (Fixed Effects) via dummies variables**

```{r}
fixed.dum = lm(Life_Expectancy_World_Bank ~ 
                      Prevelance_of_Undernourishment + 
                      CO2 + 
                      Health_Expenditure_. + 
                      Unemployment + 
                      Health_Risk_Index + 
                      IncomeGroup + factor(Country), data = panel)
summary(fixed.dum)
```

### üìä **Interpr√©tation des r√©sultats**

1\. **Intercept (Constante)**

-   **Estimate**: 65.65

-   **Interpr√©tation**: Lorsque toutes les variables explicatives sont √©gales √†
    z√©ro (ce qui peut ne pas avoir de sens concret ici, notamment pour les
    variables comme le pays), l'esp√©rance de vie (Life_Expectancy_World_Bank)
    serait de 65.65. Cependant, cela n'a pas de r√©elle signification pratique,
    car cela implique un √©tat fictif o√π toutes les autres variables sont nulles.

2\. **Variables explicatives** :

-   **Prevalence_of_Undernourishment (Pr√©valence de la sous-nutrition)** :

    -   **Estimate**: -0.2726

    -   **Interpr√©tation**: Un accroissement de la sous-nutrition de 1 unit√© est
        associ√© √† une diminution de l'esp√©rance de vie de 0.2726 ann√©es, toutes
        choses √©gales par ailleurs.Le p-value extr√™mement faible (\<2e-16)
        montre que cet effet est statistiquement significatif.

-   **CO2 (√âmissions de CO2)** :

    -   **Estimate**: 0.0001424

    -   **Interpr√©tation**: Chaque augmentation d'une unit√© des √©missions de CO2
        est associ√©e √† une augmentation de 0.0001424 ann√©es de l'esp√©rance de
        vie, toutes choses √©gales par ailleurs. Ce qui peut sembler
        contre-intuitif, mais peut √™tre d√ª √† des facteurs indirects qui ne sont
        pas imm√©diatement apparents.Bien que l'effet soit faible, il est
        statistiquement significatif avec un p-value tr√®s bas (8.74e-11).

-   **Health_Expenditure\_ (D√©penses de sant√©)** :

    -   **Estimate**: 0.5519

    -   **Interpr√©tation**: Une augmentation d'une unit√© des d√©penses de sant√©
        est associ√©e √† une augmentation de 0.5519 ann√©es de l'esp√©rance de vie,
        toutes choses √©gales par ailleurs. L'effet est tr√®s significatif
        (p-value = 1.62e-06).

-   **Unemployment (Taux de ch√¥mage)** :

    -   **Estimate**: -0.3711

    -   **Interpr√©tation**: Une augmentation du taux de ch√¥mage est associ√©e √†
        une diminution de l'esp√©rance de vie de 0.3711 ann√©es. Cet effet est
        √©galement statistiquement significatif (p-value = 0.000249).

-   **Health_Risk_Index (Indice de risque sanitaire)** :

    -   **Estimate**: 3.900

    -   **Interpr√©tation**: Une augmentation de l'indice de risque sanitaire de
        1 unit√© est associ√©e √† une augmentation de l'esp√©rance de vie de 3.900
        ann√©es, toutes choses √©gales par ailleurs.Ce qui peut sembler
        contre-intuitif, mais peut √™tre d√ª √† des facteurs indirects qui ne sont
        pas imm√©diatement apparents.

-   **IncomeGroup (Groupe de revenu)** :

    -   **Estimate**: pour les groupes de revenu "Lower middle income" et "Upper
        middle income", il y a des r√©ductions significatives de l'esp√©rance de
        vie par rapport aux pays √† revenu √©lev√©. Par exemple, pour "Upper middle
        income", l'esp√©rance de vie diminue de 68.01 ans.

3\. **Effets fixes des pays (factor(Country))** :

-   Les coefficients des pays repr√©sentent l'effet sp√©cifique de chaque pays sur
    l'esp√©rance de vie, par rapport au pays de r√©f√©rence qui est **Angola**.

-   **Pays significatifs** : De nombreux pays comme le **Botswana**, **Gabon**,
    **Maurice**, **S√©n√©gal**, **Sierra Leone** montrent des coefficients
    significatifs, sugg√©rant que l'esp√©rance de vie dans ces pays est
    statistiquement diff√©rente de la moyenne.

-   **Pays non significatifs** : Certains pays comme **South Africa** et
    **Togo** ont des valeurs manquantes (NA), ce qui signifie que ces pays sont
    probablement exclus du mod√®le ou souffrent de multicolin√©arit√©.

4\. **Autres statistiques** :

-   **Residual standard error (Erreur standard des r√©sidus)** : 3.424, ce qui
    indique l'√©cart-type des erreurs de pr√©diction.

-   **Multiple R-squared** : 0.7745, ce qui signifie que 77.45% de la variance
    de l'esp√©rance de vie est expliqu√©e par le mod√®le.

-   **Adjusted R-squared** : 0.7602, qui ajuste R¬≤ en fonction du nombre de
    variables explicatives, offrant ainsi une meilleure estimation de la qualit√©
    du mod√®le.

5\. **Significativit√© du mod√®le global** :

-   **F-statistic** : 54.26 avec un p-value extr√™mement faible (\< 2.2e-16),
    indiquant que le mod√®le est significatif dans son ensemble.

**Conclusion** :

Le mod√®le montre que plusieurs facteurs, notamment la sous-nutrition, les
√©missions de CO2, les d√©penses de sant√© et le ch√¥mage, influencent de mani√®re
significative l'esp√©rance de vie. De plus, l'analyse des effets fixes par pays
montre qu'il existe des diff√©rences significatives entre les pays en termes
d'esp√©rance de vie, ce qui justifie l'inclusion de ces effets pour contr√¥ler les
sp√©cificit√©s nationales.

## **Mod√®le √† Effets Fixes (Fixed Effects) via plm**

```{r}
fe_model <- plm(Life_Expectancy_World_Bank ~ 
                  Prevelance_of_Undernourishment + 
                  CO2 + 
                  Health_Expenditure_. + 
                  Unemployment + 
                  Health_Risk_Index + 
                  IncomeGroup,
                data = panel, 
                model = "within")  
summary(fe_model)

```

### üìä **Interpr√©tation des r√©sultats**

Chaque coefficient repr√©sente l'**effet moyen d'une variation d'une unit√© de la
variable explicative sur l'esp√©rance de vie**, **en contr√¥lant les effets
sp√©cifiques aux pays**.

-   **Prevalence_of_Undernourishment (-0.2726, p \< 0.001)**\
    ‚Üí Une augmentation de 1 point de pourcentage de la pr√©valence de la
    sous-alimentation est associ√©e √† une baisse de **0.273 ann√©es** d'esp√©rance
    de vie. Cet effet est **tr√®s significatif** (p \< 0.001).

-   **CO2 (0.000142, p \< 0.001)**\
    ‚Üí Une augmentation de 1 unit√© des √©missions de CO‚ÇÇ est associ√©e √† une **tr√®s
    l√©g√®re augmentation de l'esp√©rance de vie (+0.000142 ann√©es)**. Cet effet
    est **statistiquement significatif** mais √©conomiquement tr√®s faible.

-   **Health_Expenditure\_. (0.552, p \< 0.001)**\
    ‚Üí Une augmentation de 1% des d√©penses de sant√© par rapport au PIB est
    associ√©e √† une **augmentation de 0.55 ann√©es d'esp√©rance de vie**. Cela
    indique que l'investissement dans la sant√© am√©liore significativement
    l'esp√©rance de vie.

-   **Unemployment (-0.371, p = 0.000249)**\
    ‚Üí Une augmentation de 1 point de pourcentage du ch√¥mage est associ√©e √† une
    baisse de **0.37 ann√©es** d'esp√©rance de vie. Cela peut s'expliquer par le
    stress, l'acc√®s r√©duit aux soins et d'autres facteurs li√©s √† l'emploi.

-   **Health_Risk_Index (3.90, p = 0.0024)**\
    ‚Üí Une augmentation de **1 point** de cet indice de risque sanitaire est
    associ√©e √† une hausse de **3.90 ans d'esp√©rance de vie**. Cela peut sembler
    contre-intuitif, mais cela pourrait √™tre d√ª √† une corr√©lation avec d'autres
    facteurs (exemple : des pays avec un bon syst√®me de sant√© pourraient aussi
    mieux d√©tecter et surveiller les risques).

--------------------------------------------------------------------------------

**Signification globale du mod√®le**

-   **R¬≤ = 0.2914** :\
    ‚Üí Cela signifie que **29.14% de la variance de l'esp√©rance de vie** est
    expliqu√©e par les variables du mod√®le. C'est un niveau mod√©r√©, ce qui
    signifie que d'autres facteurs non inclus dans le mod√®le jouent un r√¥le
    important.

-   **F-statistic = 45.49, p \< 2.2e-16** :\
    ‚Üí Ce test confirme que l'ensemble des variables explicatives a un effet
    significatif sur l'esp√©rance de vie.

--------------------------------------------------------------------------------

### **Conclusion**

‚úÖ **Variables les plus influentes** :

-   **D√©penses de sant√© (+)** et **sous-alimentation (-)** sont les facteurs les
    plus influents sur l'esp√©rance de vie.

‚ö†Ô∏è **R√©sultats contre-intuitifs** :

-   L'effet l√©g√®rement positif du CO‚ÇÇ est surprenant. Il pourrait refl√©ter une
    relation indirecte (par exemple, les pays d√©velopp√©s √©mettent plus de CO‚ÇÇ
    mais ont aussi une meilleure esp√©rance de vie).

üîç **Am√©liorations possibles** :

-   Tester d'autres mod√®les (effets al√©atoires, variables instrumentales) pour
    valider la robustesse des r√©sultats.

-   Ajouter d'autres variables

### **Afficher les effets fixes**

```{r}
fixef(fe_model)

```

### üìä **Analyse des effets fixes par pays :**

‚úÖ **Pays avec les effets fixes les plus √©lev√©s :**

-   **Maurice (78.92), S√£o Tom√©-et-Principe (75.88), Gabon (74.53), Botswana
    (73.23), Madagascar (72.14)**\
    ‚Üí Ces pays ont une **esp√©rance de vie syst√©matiquement plus √©lev√©e** par
    rapport aux autres, m√™me apr√®s contr√¥le des facteurs comme la
    sous-alimentation, les d√©penses de sant√©, etc.\
    **Explication possible :** meilleure infrastructure de sant√©, politiques
    publiques efficaces, niveau de vie plus √©lev√©.

‚ö†Ô∏è **Pays avec des effets fixes moyens :**

-   **B√©nin (62.54), Ghana (61.72), Kenya (61.60), Lesotho (61.86), Angola
    (60.49)**\
    ‚Üí Ces pays ont une **esp√©rance de vie conforme aux attentes du mod√®le**,
    sans d√©viation majeure.

‚ùå **Pays avec les effets fixes les plus faibles :**

-   **Nigeria (8.92), Afrique du Sud (-2.36)**\
    ‚Üí Ces pays ont une **esp√©rance de vie bien plus basse que pr√©vu**, m√™me
    apr√®s contr√¥le des variables explicatives.\
    **Explication possible :**

    -   Pour le Nigeria : conflits, pauvret√© √©lev√©e, acc√®s limit√© aux soins.

    -   Pour l'Afrique du Sud : fort impact du VIH/SIDA, in√©galit√©s de sant√©,
        violence √©lev√©e.

## **Choix du mod√®le**

### **S√©lection de Mod√®le : POOLED OLS OR FIXED?**

#### **Test Fisher : comparaison Fixed Effects vs OLS**

```{r}
library(plm)
pFtest(fe_model, pooled_model)

```

#### üìä **Interpr√©tation des r√©sultats**

Le test de Fisher pour les effets individuels a produit une statistique F de
40,41 avec des degr√©s de libert√© de 28 et 553, et une p-value tr√®s faible
(inf√©rieure √† 2,2e-16). Cette p-value indique que l'hypoth√®se nulle (selon
laquelle il n'y a pas d'effets individuels significatifs) peut √™tre rejet√©e.

En d'autres termes, les r√©sultats sugg√®rent qu'il existe des effets fixes
significatifs , ce qui signifie que les diff√©rences entre les pays jouent un
r√¥le important dans l'explication de la variable d√©pendante(l'esp√©rance de vie).

On peut conclure qu'**il est pertinent d'utiliser un** **mod√®le √† effets fixes**
plut√¥t qu'un mod√®le √† pooled.

### **S√©lection de Mod√®le : FIXED OR RANDOM?**

#### **Mod√®le √† Effets Al√©atoires (Random Effects) via plm**

```{r}
re_model <- plm(Life_Expectancy_World_Bank ~ 
                  Prevelance_of_Undernourishment +
                  CO2 + 
                  Health_Expenditure_. + 
                  Unemployment + 
                  Health_Risk_Index + 
                  IncomeGroup,
                data = panel, 
                model = "random")  
summary(re_model)
```

#### **Test de Hausman : comparaison Fixed effects vs Random effets**

```{r}
hausman_test <- phtest(fe_model, re_model)
hausman_test
```

**Conclusion :**

L'hypoth√®se nulle du test de Hausman stipule que les effets al√©atoires sont plus
appropri√©s, c'est-√†-dire que les variables explicatives ne sont pas corr√©l√©es
avec les effets individuels.

Toutefois, ici, la **p-value est tr√®s faible**, ce qui signifie que nous
**rejetons l'hypoth√®se nulle**. Autrement dit, le mod√®le √† **effets al√©atoires
est biais√© et incoh√©rent**, et **le mod√®le √† effets fixes est pr√©f√©rable**.

En somme le mod√®le le plus adapt√© pour ce data_panel est le **mod√®le √† effet
fixe**.

## **Analyse de l'Importance des Effets Temporels üïí**

### **Estimation du mod√®le √† effets fixes temporel**

```{r}
fe_model_time <- plm(Life_Expectancy_World_Bank ~ 
                           Prevelance_of_Undernourishment + 
                           CO2 + 
                           Health_Expenditure_. + 
                           Unemployment + 
                           Health_Risk_Index + 
                           IncomeGroup + factor(Year),
                         data = panel)  # Effets fixes temporels uniquement

summary(fe_model_time)

```

### **Comparaison des Mod√®les avec et sans Effets Temporels**

-   Hypoth√®se nulle (H0) : Les effets fixes temporels ne sont pas n√©cessaires.

```{r}
pFtest(fe_model_time,fe_model)

```

**üìå Interpr√©tation du Test de Fisher (`pFtest`) entre `fe_model_time` et
`fe_model`**

Ce test compare **le mod√®le √† effets fixes temporels (`fe_model_time`)** avec
**le mod√®le √† effets fixes individuels (`fe_model`)** pour v√©rifier si les
**effets fixes temporels sont significatifs**.

--------------------------------------------------------------------------------

**üìä R√©sultats du test :**

-   **Statistique F = 98.551** ‚Üí Valeur tr√®s √©lev√©e, ce qui indique une forte
    diff√©rence entre les mod√®les.

-   **p-value \< 2.2e-16** ‚Üí **Tr√®s faible (inf√©rieure √† 5%)**, donc on
    **rejette l'hypoth√®se nulle**.

--------------------------------------------------------------------------------

**üìå Conclusion :**

‚úÖ **Les effets fixes temporels sont significatifs**.\
‚û° **Il faut donc inclure les effets fixes temporels dans le mod√®le**
(`fe_model_time`).

Cela signifie que **l'effet du temps joue un r√¥le important** sur la variable
d√©pendante (*Life Expectancy*). Ignorer ces effets reviendrait √† omettre une
composante cl√© de l'analyse.

--------------------------------------------------------------------------------

**üöÄ Que faire ensuite ?**

1Ô∏è‚É£ **Garder `fe_model_time`** comme mod√®le principal.\
2Ô∏è‚É£ **Tester les diagnostics** (h√©t√©rosc√©dasticit√©, autocorr√©lation, etc.) pour
s'assurer de la robustesse du mod√®le.

## **Validation du mod√®le**

### **V√©rification de l'H√©t√©rog√©n√©it√©**

```{r}
pcdtest(fe_model_time)

```

On constate qu'il y a pas de d√©pendance entre les erreurs du mod√®le (p-value =
0.1379\>0,05)

### Test d'H√©t√©rosc√©dasticit√© (variance non constante)

```{r}
library(lmtest)
bptest(fe_model_time)
```

#### üîπ **Interpr√©tation :**

-   **p-value \< 0.05** ‚Üí Pr√©sence d'h√©t√©rosc√©dasticit√© ‚Üí On devra utiliser des
    erreurs standard robustes pour corriger ce probl√®me.


```{r}
library(sandwich)
robust_se <- sqrt(diag(vcovHC(fe_model_time, type = "HC3", cluster = "group")))
summary(fe_model_time)

```

### Test d'Autocorr√©lation des Erreurs

```{r}
pwartest(fe_model_time)
```

üîπ **Interpr√©tation :**

-   **p-value \< 0.05** ‚Üí Pr√©sence d'autocorr√©lation ‚Üí Il est n√©cessaire
    d'ajuster le mod√®le (par exemple, utiliser des erreurs robustes pour
    l'autocorr√©lation).
    
###  Correction de l‚Äôh√©t√©rosc√©dasticit√© et l‚Äôautocorr√©lation
Pour corriger l‚Äôh√©t√©rosc√©dasticit√© et l‚Äôautocorr√©lation dans un mod√®le de panel, plusieurs approches peuvent √™tre
utilis√©es. Une premi√®re m√©thode consiste √† appliquer des **erreurs robustes aux h√©t√©rosc√©dasticit√©s et aux corr√©lations intra-groupes**  , en utilisant des matrices de variance-covariance corrig√©es comme **Arellano** ou des erreurs clusteris√©es
par individu ou par p√©riode **(vcovHC)**. Une seconde approche repose sur la transformation des variables, notamment
par diff√©renciation pour √©liminer la structure d‚Äôautocorr√©lation. Enfin, dans le cas o√π la d√©pendance temporelle est
forte, un mod√®le de panel dynamique, comme le **GMM d‚ÄôArellano-Bond**, permet de prendre en compte √† la fois
l‚Äôautocorr√©lation et les probl√®mes d‚Äôendog√©n√©it√© en utilisant des instruments appropri√©s. Le choix de la m√©thode d√©pend
du degr√© et de la nature des distorsions d√©tect√©es √† travers des tests comme Breusch-Pagan pour l‚Äôh√©t√©rosc√©dasticit√© et
Wooldridge pour l‚Äôautocorr√©lation.


# Conclusion
L‚Äôanalyse en panel men√©e sur les d√©terminants de l‚Äôesp√©rance de vie en Afrique subsaharienne a mis en √©vidence des disparit√©s
significatives entre les pays et les ann√©es. √Ä travers diff√©rentes approches de mod√©lisation, nous avons identifi√© des facteurs cl√©s
influen√ßant l‚Äôesp√©rance de vie, notamment la sous-alimentation, le ch√¥mage et les d√©penses de sant√©. L‚Äôimportance des effets
fixes a √©t√© d√©montr√©e, indiquant que des caract√©ristiques sp√©cifiques √† chaque pays jouent un r√¥le majeur dans l‚Äô√©volution de cet
indicateur.
Nos r√©sultats soulignent que l‚Äôam√©lioration de l‚Äôesp√©rance de vie passe par une augmentation des investissements en sant√©
publique et une r√©duction des in√©galit√©s socio-√©conomiques. Les politiques publiques devraient ainsi se concentrer sur des
strat√©gies de r√©duction du ch√¥mage et de lutte contre la sous-alimentation pour favoriser une meilleure qualit√© de vie dans la
r√©gion.
En perspective, des √©tudes compl√©mentaires int√©grant d‚Äôautres variables structurelles et des techniques √©conom√©triques
avanc√©es, comme les mod√®les dynamiques ou les m√©thodes de correction des effets endog√®nes, pourraient affiner ces r√©sultats et
renforcer la robustesse des conclusions obtenues
